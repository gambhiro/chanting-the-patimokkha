\documentclass[10pt,landscape]{article}

\makeatletter

\usepackage{graphicx}
\graphicspath{{./images/}}
\usepackage{xcolor}

%\definecolor[RGB]{dark-orange}{F69A00}

\usepackage{fontspec}
\setmainfont[Ligatures=TeX]{TeX Gyre Pagella}

\usepackage{amsmath}
\usepackage{calc}
\usepackage{eso-pic}

\usepackage{tikz}
\usetikzlibrary{positioning}

\usepackage{pgfplots}
\usepgfplotslibrary{dateplot}

\usepackage{pgfcalendar}
\usepackage{pgfplotstable}

\usepackage{geometry}
\geometry{paper=a5paper, landscape}

\pgfplotstableset{string type,col sep=comma}

\pagestyle{empty}

\pgfplotsset{compat=1.13}

\makeatother

\begin{document}
\mbox{}

\AddToShipoutPictureFG*{\put(\LenToUnit{0.5cm},\LenToUnit{0.5cm}){%
\begin{minipage}[b][\paperheight - 1cm]{\paperwidth - 1cm}
\begin{tikzpicture}
\begin{axis}[
    title=Chanting the Pāṭimokkha,
    width=20cm,
    height=12cm,
    clip=false,
    date coordinates in=x,
    date ZERO=2014-11-21,
    cycle list={%
      {blue,mark=*,mark size=1pt},
    },
    ylabel=Time (mins),
    xtick=data,
    xmin=2014-11-20,
    xmax=2017-12-31,
    enlarge x limits={rel=0.02,lower},
    xticklabel style={yshift=-20pt,rotate=90,anchor=east,font=\small},
    xticklabel={\year-\month-\day},
    unbounded coords=jump,
    ymin=0,
    ymax=120,
    legend pos=north east,
    legend style={draw=none},
  ]

  \addplot[
    ybar,
    draw=none,
    fill=blue!30,
    nodes near coords,
    area legend,
  ] table[x=date,y=minutes] {./plotdata/patimokkha-chanting.csv};
  \addlegendentry{time};

  \addplot[
    ybar,
    draw=none,
    fill=orange,
    nodes near coords,
    area legend,
  ] table[x=date,y=bhikkhus] {./plotdata/patimokkha-chanting.csv};
  \addlegendentry{bhikkhus};

  \node [anchor=south, yshift=-20pt] at (axis cs:2014-11-21,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-04-03,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-04-17,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-05-17,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-06-15,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-06-30,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-07-30,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-08-29,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-09-12,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-10-12,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2015-11-25,0) {\includegraphics[width=5mm]{gb}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-02-22,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-04-06,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-05-20,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-07-19,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-08-03,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-09-01,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-11-14,0) {\includegraphics[width=5mm]{gb}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-11-29,0) {\includegraphics[width=5mm]{gb}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2016-12-14,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-01-12,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-01-27,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-02-25,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-03-12,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-03-27,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-04-11,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-04-25,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-05-10,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-07-08,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-07-23,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-08-07,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-08-21,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-09-05,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-09-20,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-11-03,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-11-18,0) {\includegraphics[width=5mm]{pt}};
  \node [anchor=south, yshift=-20pt] at (axis cs:2017-12-03,0) {\includegraphics[width=5mm]{gb}};

\end{axis}
\end{tikzpicture}
\vfill\par\mbox{}
\end{minipage}%
}}

\end{document}

